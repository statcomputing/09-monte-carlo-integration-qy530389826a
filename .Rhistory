optValueAppr <- function(n, r, sigma, S0, K, tgrid) {
nt <- length(tgrid)
TT <- tgrid[nt]
St <- rBM(n, tgrid, sigma, r, S0)
pAri <- pmax(rowMeans(St) - K, 0) * exp(-r * TT)
ST <- St[, nt]
pStd <- pmax(ST - K, 0) * exp(-r * TT)
pGeo <- pmax(exp(rowMeans(log(St))) - K, 0) * exp(-r * TT)
list(pAri = pAri, ST = ST, pStd = pStd, pGeo = pGeo )
}
n = 5000;
r = 0.05;
sigma = 0.5;
S0 = 1;
tgrid = seq(0, 1, length = 12)[-1]
k<-c(1.1,1.2,1.3,1.4,1.5)
for (i in 1:5) {
re[i] = optValueAppr(n, r, sigma, S0, K =[i], tgrid)
optValueAppr <- function(n, r, sigma, S0, K, tgrid) {
nt <- length(tgrid)
TT <- tgrid[nt]
St <- rBM(n, tgrid, sigma, r, S0)
pAri <- pmax(rowMeans(St) - K, 0) * exp(-r * TT)
ST <- St[, nt]
pStd <- pmax(ST - K, 0) * exp(-r * TT)
pGeo <- pmax(exp(rowMeans(log(St))) - K, 0) * exp(-r * TT)
list(pAri = pAri, ST = ST, pStd = pStd, pGeo = pGeo )
}
n = 5000;
r = 0.05;
sigma = 0.5;
S0 = 1;
tgrid = seq(0, 1, length = 12)[-1]
k<-c(1.1,1.2,1.3,1.4,1.5)
for (i in 1:5) {
re[i] = optValueAppr(n, r, sigma, S0, K =k[i], tgrid)
}
optValueAppr <- function(n, r, sigma, S0, K, tgrid) {
nt <- length(tgrid)
TT <- tgrid[nt]
St <- rBM(n, tgrid, sigma, r, S0)
pAri <- pmax(rowMeans(St) - K, 0) * exp(-r * TT)
ST <- St[, nt]
pStd <- pmax(ST - K, 0) * exp(-r * TT)
pGeo <- pmax(exp(rowMeans(log(St))) - K, 0) * exp(-r * TT)
list(pAri = pAri, ST = ST, pStd = pStd, pGeo = pGeo )
}
set.seed(123)
n = 5000; r = 0.05; sigma = 0.5; S0 = 1; tgrid = seq(0, 1, length = 12)[-1]
re1 = optValueAppr(n, r, sigma, S0, K = 1.1, tgrid)
re2 = optValueAppr(n, r, sigma, S0, K = 1.2, tgrid)
re3 = optValueAppr(n, r, sigma, S0, K = 1.3, tgrid)
re4 = optValueAppr(n, r, sigma, S0, K = 1.4, tgrid)
re5 = optValueAppr(n, r, sigma, S0, K = 1.5, tgrid)
k1 = cbind(cor(re1$pAri,re1$ST),cor(re1$pAri,re1$pStd),cor(re1$pAri,re1$pGeo))
k2 = cbind(cor(re2$pAri,re2$ST),cor(re2$pAri,re2$pStd),cor(re2$pAri,re2$pGeo))
k3 = cbind(cor(re3$pAri,re3$ST),cor(re3$pAri,re3$pStd),cor(re3$pAri,re3$pGeo))
k4 = cbind(cor(re4$pAri,re4$ST),cor(re4$pAri,re4$pStd),cor(re4$pAri,re4$pGeo))
k5 = cbind(cor(re5$pAri,re5$ST),cor(re5$pAri,re5$pStd),cor(re5$pAri,re5$pGeo))
re = data.frame(K=c(1.1, 1.2 ,1.3 ,1.4 ,1.5), rbind(k1,k2,k3,k4,k5))
colnames(re) = c("K", 'cor(P(A),S(T))','cor(P(A),P(E))','cor(P(A),P(G))')
library(pander)
pander(re)
optValueAppr <- function(n, r, sigma, S0, K, tgrid) {
nt <- length(tgrid)
TT <- tgrid[nt]
St <- rBM(n, tgrid, sigma, r, S0)
pAri <- pmax(rowMeans(St) - K, 0) * exp(-r * TT)
ST <- St[, nt]
pStd <- pmax(ST - K, 0) * exp(-r * TT)
pGeo <- pmax(exp(rowMeans(log(St))) - K, 0) * exp(-r * TT)
list(pAri = pAri, ST = ST, pStd = pStd, pGeo = pGeo )
}
n = 5000;
r = 0.05;
sigma = 0.5;
S0 = 1;
tgrid = seq(0, 1, length = 12)[-1]
k<-c(1.1,1.2,1.3,1.4,1.5)
for (i in 1:5) {
optValueAppr(n, r, sigma, S0, K =k[i], tgrid)
}
optValueAppr <- function(n, r, sigma, S0, K, tgrid) {
nt <- length(tgrid)
TT <- tgrid[nt]
St <- rBM(n, tgrid, sigma, r, S0)
pAri <- pmax(rowMeans(St) - K, 0) * exp(-r * TT)
ST <- St[, nt]
pStd <- pmax(ST - K, 0) * exp(-r * TT)
pGeo <- pmax(exp(rowMeans(log(St))) - K, 0) * exp(-r * TT)
list(pAri = pAri, ST = ST, pStd = pStd, pGeo = pGeo )
}
n = 5000;
r = 0.05;
sigma = 0.5;
S0 = 1;
tgrid = seq(0, 1, length = 12)[-1]
k<-c(1.1,1.2,1.3,1.4,1.5)
for (i in 1:5) {
print(optValueAppr(n, r, sigma, S0, K =k[i], tgrid))
}
optValueAppr <- function(n, r, sigma, S0, K, tgrid) {
nt <- length(tgrid)
TT <- tgrid[nt]
St <- rBM(n, tgrid, sigma, r, S0)
pAri <- pmax(rowMeans(St) - K, 0) * exp(-r * TT)
ST <- St[, nt]
pStd <- pmax(ST - K, 0) * exp(-r * TT)
pGeo <- pmax(exp(rowMeans(log(St))) - K, 0) * exp(-r * TT)
list(pAri = pAri, ST = ST, pStd = pStd, pGeo = pGeo )
}
n = 5000;
r = 0.05;
sigma = 0.5;
S0 = 1;
tgrid = seq(0, 1, length = 12)[-1]
k<-c(1.1,1.2,1.3,1.4,1.5)
for (i in 1:5) {
res<-optValueAppr(n, r, sigma, S0, K =k[i], tgrid)
print(cor(re1$pAri,re1$ST),cor(re1$pAri,re1$pStd),cor(re1$pAri,re1$pGeo)
}
optValueAppr <- function(n, r, sigma, S0, K, tgrid) {
nt <- length(tgrid)
TT <- tgrid[nt]
St <- rBM(n, tgrid, sigma, r, S0)
pAri <- pmax(rowMeans(St) - K, 0) * exp(-r * TT)
ST <- St[, nt]
pStd <- pmax(ST - K, 0) * exp(-r * TT)
pGeo <- pmax(exp(rowMeans(log(St))) - K, 0) * exp(-r * TT)
list(pAri = pAri, ST = ST, pStd = pStd, pGeo = pGeo )
}
n = 5000;
r = 0.05;
sigma = 0.5;
S0 = 1;
tgrid = seq(0, 1, length = 12)[-1]
k<-c(1.1,1.2,1.3,1.4,1.5)
for (i in 1:5) {
res<-optValueAppr(n, r, sigma, S0, K =k[i], tgrid)
print(cor(re$pAri,re$ST),cor(re$pAri,re$pStd),cor(re$pAri,re$pGeo)
}
optValueAppr <- function(n, r, sigma, S0, K, tgrid) {
nt <- length(tgrid)
TT <- tgrid[nt]
St <- rBM(n, tgrid, sigma, r, S0)
pAri <- pmax(rowMeans(St) - K, 0) * exp(-r * TT)
ST <- St[, nt]
pStd <- pmax(ST - K, 0) * exp(-r * TT)
pGeo <- pmax(exp(rowMeans(log(St))) - K, 0) * exp(-r * TT)
list(pAri = pAri, ST = ST, pStd = pStd, pGeo = pGeo )
}
n = 5000;
r = 0.05;
sigma = 0.5;
S0 = 1;
tgrid = seq(0, 1, length = 12)[-1]
k<-c(1.1,1.2,1.3,1.4,1.5)
for (i in 1:5) {
res<-optValueAppr(n, r, sigma, S0, K =k[i], tgrid)
print(cor(re$pAri,re$ST),cor(re$pAri,re$pStd),cor(re$pAri,re$pGeo))
}
View(res)
optValueAppr <- function(n, r, sigma, S0, K, tgrid) {
nt <- length(tgrid)
TT <- tgrid[nt]
St <- rBM(n, tgrid, sigma, r, S0)
pAri <- pmax(rowMeans(St) - K, 0) * exp(-r * TT)
ST <- St[, nt]
pStd <- pmax(ST - K, 0) * exp(-r * TT)
pGeo <- pmax(exp(rowMeans(log(St))) - K, 0) * exp(-r * TT)
list(pAri = pAri, ST = ST, pStd = pStd, pGeo = pGeo )
}
n = 5000;
r = 0.05;
sigma = 0.5;
S0 = 1;
tgrid = seq(0, 1, length = 12)[-1]
k<-c(1.1,1.2,1.3,1.4,1.5)
for (i in 1:5) {
res<-optValueAppr(n, r, sigma, S0, K =k[i], tgrid)
}
optValueAppr <- function(n, r, sigma, S0, K, tgrid) {
nt <- length(tgrid)
TT <- tgrid[nt]
St <- rBM(n, tgrid, sigma, r, S0)
pAri <- pmax(rowMeans(St) - K, 0) * exp(-r * TT)
ST <- St[, nt]
pStd <- pmax(ST - K, 0) * exp(-r * TT)
pGeo <- pmax(exp(rowMeans(log(St))) - K, 0) * exp(-r * TT)
list(pAri = pAri, ST = ST, pStd = pStd, pGeo = pGeo )
}
n = 5000;
r = 0.05;
sigma = 0.5;
S0 = 1;
tgrid = seq(0, 1, length = 12)[-1]
k<-c(1.1,1.2,1.3,1.4,1.5)
for (i in 1:5) {
res<-optValueAppr(n, r, sigma, S0, K =k[i], tgrid)
print(list(cor(re$pAri,re$ST),cor(re$pAri,re$pStd),cor(re$pAri,re$pGeo)))
}
optValueAppr <- function(n, r, sigma, S0, K, tgrid) {
nt <- length(tgrid)
TT <- tgrid[nt]
St <- rBM(n, tgrid, sigma, r, S0)
pAri <- pmax(rowMeans(St) - K, 0) * exp(-r * TT)
ST <- St[, nt]
pStd <- pmax(ST - K, 0) * exp(-r * TT)
pGeo <- pmax(exp(rowMeans(log(St))) - K, 0) * exp(-r * TT)
list(pAri = pAri, ST = ST, pStd = pStd, pGeo = pGeo )
}
n = 5000;
r = 0.05;
sigma = 0.5;
S0 = 1;
tgrid = seq(0, 1, length = 12)[-1]
k<-c(1.1,1.2,1.3,1.4,1.5)
for (i in 1:5) {
res<-optValueAppr(n, r, sigma, S0, K =k[i], tgrid)
print(c(cor(re$pAri,re$ST),cor(re$pAri,re$pStd),cor(re$pAri,re$pGeo)))
}
optValueAppr <- function(n, r, sigma, S0, K, tgrid) {
nt <- length(tgrid)
TT <- tgrid[nt]
St <- rBM(n, tgrid, sigma, r, S0)
pAri <- pmax(rowMeans(St) - K, 0) * exp(-r * TT)
ST <- St[, nt]
pStd <- pmax(ST - K, 0) * exp(-r * TT)
pGeo <- pmax(exp(rowMeans(log(St))) - K, 0) * exp(-r * TT)
list(pAri = pAri, ST = ST, pStd = pStd, pGeo = pGeo )
}
n = 5000;
r = 0.05;
sigma = 0.5;
S0 = 1;
tgrid = seq(0, 1, length = 12)[-1]
k<-c(1.1,1.2,1.3,1.4,1.5)
for (i in 1:5) {
res<-optValueAppr(n, r, sigma, S0, K =k[i], tgrid)
cor(re$pAri,re$ST)
cor(re$pAri,re$pStd)
cor(re$pAri,re$pGeo)
}
cor(re$pAri,re$ST)
res$pAri
optValueAppr <- function(n, r, sigma, S0, K, tgrid) {
nt <- length(tgrid)
TT <- tgrid[nt]
St <- rBM(n, tgrid, sigma, r, S0)
pAri <- pmax(rowMeans(St) - K, 0) * exp(-r * TT)
ST <- St[, nt]
pStd <- pmax(ST - K, 0) * exp(-r * TT)
pGeo <- pmax(exp(rowMeans(log(St))) - K, 0) * exp(-r * TT)
list(pAri = pAri, ST = ST, pStd = pStd, pGeo = pGeo )
}
n = 5000;
r = 0.05;
sigma = 0.5;
S0 = 1;
tgrid = seq(0, 1, length = 12)[-1]
k<-c(1.1,1.2,1.3,1.4,1.5)
for (i in 1:5) {
res<-optValueAppr(n, r, sigma, S0, K =k[i], tgrid)
cor(res$pAri,res$ST)
cor(res$pAri,res$pStd)
cor(res$pAri,res$pGeo)
}
optValueAppr <- function(n, r, sigma, S0, K, tgrid) {
nt <- length(tgrid)
TT <- tgrid[nt]
St <- rBM(n, tgrid, sigma, r, S0)
pAri <- pmax(rowMeans(St) - K, 0) * exp(-r * TT)
ST <- St[, nt]
pStd <- pmax(ST - K, 0) * exp(-r * TT)
pGeo <- pmax(exp(rowMeans(log(St))) - K, 0) * exp(-r * TT)
list(pAri = pAri, ST = ST, pStd = pStd, pGeo = pGeo )
}
n = 5000;
r = 0.05;
sigma = 0.5;
S0 = 1;
tgrid = seq(0, 1, length = 12)[-1]
k<-c(1.1,1.2,1.3,1.4,1.5)
for (i in 1:5) {
res<-optValueAppr(n, r, sigma, S0, K =k[i], tgrid)
print(cor(res$pAri,res$ST),cor(res$pAri,res$pStd),cor(res$pAri,res$pGeo))
}
cor(res$pAri,res$ST)
optValueAppr <- function(n, r, sigma, S0, K, tgrid) {
nt <- length(tgrid)
TT <- tgrid[nt]
St <- rBM(n, tgrid, sigma, r, S0)
pAri <- pmax(rowMeans(St) - K, 0) * exp(-r * TT)
ST <- St[, nt]
pStd <- pmax(ST - K, 0) * exp(-r * TT)
pGeo <- pmax(exp(rowMeans(log(St))) - K, 0) * exp(-r * TT)
list(pAri = pAri, ST = ST, pStd = pStd, pGeo = pGeo )
}
n = 5000;
r = 0.05;
sigma = 0.5;
S0 = 1;
tgrid = seq(0, 1, length = 12)[-1]
k<-c(1.1,1.2,1.3,1.4,1.5)
for (i in 1:5) {
res<-optValueAppr(n, r, sigma, S0, K =k[i], tgrid)
print(list(cor(res$pAri,res$ST),cor(res$pAri,res$pStd),cor(res$pAri,res$pGeo)))
}
optValueAppr <- function(n, r, sigma, S0, K, tgrid) {
nt <- length(tgrid)
TT <- tgrid[nt]
St <- rBM(n, tgrid, sigma, r, S0)
pAri <- pmax(rowMeans(St) - K, 0) * exp(-r * TT)
ST <- St[, nt]
pStd <- pmax(ST - K, 0) * exp(-r * TT)
pGeo <- pmax(exp(rowMeans(log(St))) - K, 0) * exp(-r * TT)
list(pAri = pAri, ST = ST, pStd = pStd, pGeo = pGeo )
}
n = 5000;
r = 0.05;
sigma = 0.5;
S0 = 1;
tgrid = seq(0, 1, length = 12)[-1]
k<-c(1.1,1.2,1.3,1.4,1.5)
for (i in 1:5) {
res<-optValueAppr(n, r, sigma, S0, K =k[i], tgrid)
print(as.data.frame(cor(res$pAri,res$ST),cor(res$pAri,res$pStd),cor(res$pAri,res$pGeo)))
}
optValueAppr <- function(n, r, sigma, S0, K, tgrid) {
nt <- length(tgrid)
TT <- tgrid[nt]
St <- rBM(n, tgrid, sigma, r, S0)
pAri <- pmax(rowMeans(St) - K, 0) * exp(-r * TT)
ST <- St[, nt]
pStd <- pmax(ST - K, 0) * exp(-r * TT)
pGeo <- pmax(exp(rowMeans(log(St))) - K, 0) * exp(-r * TT)
list(pAri = pAri, ST = ST, pStd = pStd, pGeo = pGeo )
}
n = 5000;
r = 0.05;
sigma = 0.5;
S0 = 1;
tgrid = seq(0, 1, length = 12)[-1]
k<-c(1.1,1.2,1.3,1.4,1.5)
for (i in 1:5) {
res<-optValueAppr(n, r, sigma, S0, K =k[i], tgrid)
print(c(cor(res$pAri,res$ST),cor(res$pAri,res$pStd),cor(res$pAri,res$pGeo)))
}
optValueAppr <- function(n, r, sigma, S0, K, tgrid) {
nt <- length(tgrid)
TT <- tgrid[nt]
St <- rBM(n, tgrid, sigma, r, S0)
pAri <- pmax(rowMeans(St) - K, 0) * exp(-r * TT)
ST <- St[, nt]
pStd <- pmax(ST - K, 0) * exp(-r * TT)
pGeo <- pmax(exp(rowMeans(log(St))) - K, 0) * exp(-r * TT)
list(pAri = pAri, ST = ST, pStd = pStd, pGeo = pGeo )
}
n = 5000;
r = 0.05;
sigma = 0.5;
S0 = 1;
tgrid = seq(0, 1, length = 12)[-1]
k<-c(1.1,1.2,1.3,1.4,1.5)
for (i in 1:5) {
res<-optValueAppr(n, r, sigma, S0, K =k[i], tgrid)
print(c(k[i],cor(res$pAri,res$ST),cor(res$pAri,res$pStd),cor(res$pAri,res$pGeo)))
}
set.seed(123)
n = 5000; r = 0.05; S0 = 1; K=1.5; tgrid = seq(0, 1, length = 12)[-1]
re1 = optValueAppr(n, r, sigma = 0.2, S0, K, tgrid)
re2 = optValueAppr(n, r, sigma = 0.3, S0, K, tgrid)
re3 = optValueAppr(n, r, sigma = 0.4, S0, K, tgrid)
re4 = optValueAppr(n, r, sigma = 0.5, S0, K, tgrid)
sig1 = cbind(cor(re1$pAri,re1$ST),cor(re1$pAri,re1$pStd),cor(re1$pAri,re1$pGeo))
sig2 = cbind(cor(re2$pAri,re2$ST),cor(re2$pAri,re2$pStd),cor(re2$pAri,re2$pGeo))
sig3 = cbind(cor(re3$pAri,re3$ST),cor(re3$pAri,re3$pStd),cor(re3$pAri,re3$pGeo))
sig4 = cbind(cor(re4$pAri,re4$ST),cor(re4$pAri,re4$pStd),cor(re4$pAri,re4$pGeo))
re = data.frame(sigma=c(0.2, 0.3, 0.4, 0.5), rbind(sig1, sig2, sig3, sig4))
colnames(re) = c("sigma", 'cor(P(A),S(T))','cor(P(A),P(E))','cor(P(A),P(G))')
library(pander)
pander(re)
n = 5000;
r = 0.05; S0 = 1;
K=1.5;
tgrid = seq(0, 1, length = 12)[-1]
sigma<-c(0.2,0.3,0.4,0.5)
#sigma    cor(P(A),S(T))   cor(P(A),P(E))   cor(P(A),P(G))
for (i in 1:5) {
res<-optValueAppr(n, r, sigma[i], S0, K , tgrid)
print(c(k[i],cor(res$pAri,res$ST),cor(res$pAri,res$pStd),cor(res$pAri,res$pGeo)))
}
n = 5000;
r = 0.05; S0 = 1;
K=1.5;
tgrid = seq(0, 1, length = 12)[-1]
sigma<-c(0.2,0.3,0.4,0.5)
#sigma    cor(P(A),S(T))   cor(P(A),P(E))   cor(P(A),P(G))
for (i in 1:4) {
res<-optValueAppr(n, r, sigma[i], S0, K , tgrid)
print(c(k[i],cor(res$pAri,res$ST),cor(res$pAri,res$pStd),cor(res$pAri,res$pGeo)))
}
n = 5000;
r = 0.05; S0 = 1;
K=1.5;
tgrid = seq(0, 1, length = 12)[-1]
sigma<-c(0.2,0.3,0.4,0.5)
#sigma    cor(P(A),S(T))   cor(P(A),P(E))   cor(P(A),P(G))
for (i in 1:4) {
res<-optValueAppr(n, r, sigma[i], S0, K , tgrid)
print(c(sigma[i],cor(res$pAri,res$ST),cor(res$pAri,res$pStd),cor(res$pAri,res$pGeo)))
}
t<-c(0.4,0.7,1,1.3,1.6)
for (i in 1:5) {
re = optValueAppr(n, r, sigma, S0, K, tgrid = seq(0, t[i], length = 12)[-1])
}
t<-c(0.4,0.7,1,1.3,1.6)
n = 5000;
r = 0.05;
sigma = 0.5;
S0 = 1;
K= 1.5
for (i in 1:5) {
re = optValueAppr(n, r, sigma, S0, K, tgrid = seq(0, t[i], length = 12)[-1])
}
t<-c(0.4,0.7,1,1.3,1.6)
n = 5000;
r = 0.05;
sigma = 0.5;
S0 = 1;
K= 1.5
for (i in 1:5) {
res= optValueAppr(n, r, sigma, S0, K, tgrid = seq(0, t[i], length = 12)[-1])
print(c(t[i],cor(res$pAri,res$ST),cor(res$pAri,res$pStd),cor(res$pAri,res$pGeo)))
}
callValLognorm <- function(S0, K, mu, sigma) {
d <- (log(S0 / K) + mu + sigma^2) / sigma
S0 * exp(mu + 0.5 * sigma^2) * pnorm(d) - K * pnorm(d - sigma)
}
optValueAppr <- function(n, r = 0.05, sigma = 0.3, S0 = 50, K = 50,
tgrid = seq(0, .25, length = 14)[-1]) {
nt <- length(tgrid)
TT <- tgrid[nt]
St <- rBM(n, tgrid, sigma, r, S0)
pAri <- pmax(rowMeans(St) - K, 0) * exp(-r * TT)
vAri <- mean(pAri)
ST <- St[, nt]
pStd <- pmax(ST - K, 0) * exp(-r * TT)
pGeo <- pmax(exp(rowMeans(log(St))) - K, 0) * exp(-r * TT)
pAri <- pmax(rowMeans(St) - K, 0)
tbar <- mean(tgrid)
sBar2 <- sigma^2 / nt^2 / tbar * sum( (2 * seq(nt) - 1) * rev(tgrid) )
pGeoTrue <- callValLognorm(S0, K, (r - 0.5 * sigma^2) * tbar,
sqrt(sBar2 * tbar))
vGeo <- vAri - cov(pGeo, pAri) / var(pGeo) * (mean(pGeo) - pGeoTrue * exp(-r * TT) )
c(vGeo, vAri)
}
set.seed(123)
n = 500
sim <- replicate(1000, optValueAppr(n, r = 0.05, sigma = 0.4, S0 = 1, K = 1.5,
tgrid = seq(0,1,length = 12)[-1]))
re = data.frame(rbind(apply(sim, 1, mean),apply(sim, 1, sd)))
rownames(re) <- c('Mean','SD')
colnames(re) <- c("with Control", "no Control")
pander(re)
callValLognorm <- function(S0, K, mu, sigma) {
d <- (log(S0 / K) + mu + sigma^2) / sigma
S0 * exp(mu + 0.5 * sigma^2) * pnorm(d) - K * pnorm(d - sigma)
}
optValueAppr <- function(n, r = 0.05, sigma = 0.3, S0 = 50, K = 50,tgrid = seq(0, .25, length = 14)[-1]){
nt <- length(tgrid)
TT <- tgrid[nt]
St <- rBM(n, tgrid, sigma, r, S0)
pAri <- pmax(rowMeans(St) - K, 0) * exp(-r * TT)
vAri <- mean(pAri)
ST <- St[, nt]
pStd <- pmax(ST - K, 0) * exp(-r * TT)
pGeo <- pmax(exp(rowMeans(log(St))) - K, 0) * exp(-r * TT)
pAri <- pmax(rowMeans(St) - K, 0)
tbar <- mean(tgrid)
sBar2 <- sigma^2 / nt^2 / tbar * sum( (2 * seq(nt) - 1) * rev(tgrid) )
pGeoTrue <- callValLognorm(S0, K, (r - 0.5 * sigma^2) * tbar,sqrt(sBar2 * tbar))
vGeo <- vAri - cov(pGeo, pAri) / var(pGeo) * (mean(pGeo) - pGeoTrue * exp(-r * TT) )
c(vGeo, vAri)
}
callValLognorm <- function(S0, K, mu, sigma) {
d <- (log(S0 / K) + mu + sigma^2) / sigma
S0 * exp(mu + 0.5 * sigma^2) * pnorm(d) - K * pnorm(d - sigma)
}
optValueAppr <- function(n, r = 0.05, sigma = 0.3, S0 = 50, K = 50,tgrid = seq(0, .25, length = 14)[-1]){
nt <- length(tgrid)
TT <- tgrid[nt]
St <- rBM(n, tgrid, sigma, r, S0)
pAri <- pmax(rowMeans(St) - K, 0) * exp(-r * TT)
vAri <- mean(pAri)
ST <- St[, nt]
pStd <- pmax(ST - K, 0) * exp(-r * TT)
pGeo <- pmax(exp(rowMeans(log(St))) - K, 0) * exp(-r * TT)
pAri <- pmax(rowMeans(St) - K, 0)
tbar <- mean(tgrid)
sBar2 <- sigma^2 / nt^2 / tbar * sum( (2 * seq(nt) - 1) * rev(tgrid) )
pGeoTrue <- callValLognorm(S0, K, (r - 0.5 * sigma^2) * tbar,sqrt(sBar2 * tbar))
vGeo <- vAri - cov(pGeo, pAri) / var(pGeo) * (mean(pGeo) - pGeoTrue * exp(-r * TT) )
c(vGeo, vAri)
}
sim <- replicate(1000, optValueAppr(n, r = 0.05, sigma = 0.4, S0 = 1, K = 1.5,
tgrid = seq(0,1,length = 12)[-1]))
View(sim)
apply(sim, 1, mean)
apply(sim, 1, sd))
apply(sim, 1, mean)
apply(sim, 1, sd)
