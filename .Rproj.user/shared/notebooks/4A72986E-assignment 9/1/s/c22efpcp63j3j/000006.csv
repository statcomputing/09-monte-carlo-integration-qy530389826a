"0","set.seed(234)"
"0","rBM <- function(n, tgrid, sigma, r, S0) {"
"0","  tt <- c(0, tgrid)"
"0","  dt <- diff(tt)"
"0","  nt <- length(tgrid)"
"0","  dw <- matrix(rnorm(n * nt, sd = sigma * sqrt(dt)), n, nt, byrow = TRUE)"
"0","  wt = t(apply(dw, 1, cumsum))"
"0","  St <- S0 * exp((r - sigma^2 / 2) * matrix(tgrid, n, nt, byrow = TRUE) + wt)"
"0","  return(St)"
"0","}"
"0","tgrid <-  seq(0, 1, length = 12)[-1]; sigma <- 0.5; S0=1; r=0.05; n = 1 "
"0","plot(drop(rBM(n, tgrid, sigma, r, S0)), ylab = 'Sample Path of S(t)')"
