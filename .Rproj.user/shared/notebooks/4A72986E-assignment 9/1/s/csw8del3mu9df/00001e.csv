"0","optValueAppr <- function(n, r, sigma, S0, K, tgrid) {"
"0","  nt <- length(tgrid)"
"0","  TT <- tgrid[nt]"
"0","  St <- rBM(n, tgrid, sigma, r, S0)"
"0","  pAri <- pmax(rowMeans(St) - K, 0) * exp(-r * TT)"
"0","  ST <- St[, nt]"
"0","  pStd <- pmax(ST - K, 0) * exp(-r * TT)"
"0","  pGeo <- pmax(exp(rowMeans(log(St))) - K, 0) * exp(-r * TT)"
"0","  list(pAri = pAri, ST = ST, pStd = pStd, pGeo = pGeo )"
"0","}"
"0","n = 5000;"
"0","r = 0.05; "
"0","sigma = 0.5;"
"0","S0 = 1; "
"0","tgrid = seq(0, 1, length = 12)[-1]"
"0","k<-c(1.1,1.2,1.3,1.4,1.5)"
"0",""
"0","for (i in 1:5) {"
"0"," res<-optValueAppr(n, r, sigma, S0, K =k[i], tgrid)"
"0"," print(c(k[i],cor(res$pAri,res$ST),cor(res$pAri,res$pStd),cor(res$pAri,res$pGeo)))"
"0"," }"
"1","[1]"
"1"," 1.1000000"
"1"," 0.8021155"
"1"," 0.8502488"
"1"," 0.9970769"
"1","
"
"1","[1]"
"1"," 1.2000000"
"1"," 0.7728907"
"1"," 0.8502881"
"1"," 0.9962858"
"1","
"
"1","[1]"
"1"," 1.3000000"
"1"," 0.7207941"
"1"," 0.8294551"
"1"," 0.9953299"
"1","
"
"1","[1]"
"1"," 1.4000000"
"1"," 0.6272427"
"1"," 0.7694006"
"1"," 0.9930731"
"1","
"
"1","[1]"
"1"," 1.5000000"
"1"," 0.6272389"
"1"," 0.8073227"
"1"," 0.9916552"
"1","
"
